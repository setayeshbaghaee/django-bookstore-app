{% extends "core/base.html" %}
{% load static %}

{% block content %}
<div class="container-fluid bg-secondary mb-5">
  <div class="d-flex flex-column align-items-center justify-content-center" style="min-height: 300px">
    <h1 class="font-weight-semi-bold text-uppercase mb-3">{{ category.Categoryname }}</h1>
    <div class="d-inline-flex">
      <p class="m-0"><a href="{% url 'home' %}">Home</a></p>
      <p class="m-0 px-2">-</p>
      <p class="m-0">Shop</p>
    </div>
  </div>
</div>
<div class="row">
  {% for book in books %}
  <div class="col-lg-4 col-md-6 col-sm-12 pb-1">
    <div class="card product-item border-0 mb-4">
      <div class="card-header product-img position-relative overflow-hidden bg-transparent border p-0">
        {% if book.image %}
        <img class="img-fluid" src="{{ book.image.url }}" alt="{{ book.title }}"
          style="width: 100%; height: 200px; object-fit: contain; padding: 10px; border: 2px solid #ddd; box-sizing: border-box;">
        {% else %}
        <img class="img-fluid" src="{% static 'core/img/default-image.jpg' %}" alt="No image available"
          style="width: 100%; height: 200px; object-fit: contain; padding: 10px; border: 2px solid #ddd; box-sizing: border-box;">
        {% endif %}
      </div>
      <div class="card-body border-left border-right text-center p-0 pt-4 pb-3">
        <h6 class="text-truncate mb-3">{{ book.title }}</h6>
        <div class="d-flex justify-content-center">
          <h6>{{ book.price }} </h6>
        </div>
      </div>
      <div class="card-footer d-flex justify-content-between bg-light border">
        <a href="{% url 'book_detail' book.id %}" class="btn btn-sm text-dark p-0"><i
            class="fas fa-eye text-primary mr-1"></i>View Detail</a>
            
        <a href="#" class="btn btn-sm text-dark p-0" onclick="submitAddToCart({{ book.id }})">
          <i class="fas fa-shopping-cart text-primary mr-1"></i>Add To Cart
        </a>

        <form id="add-to-cart-form-{{ book.id }}" method="post" action="{% url 'add' book.pk %}" style="display: none;">
          {% csrf_token %}
          <input type="hidden" name="item_id" value="{{ book.id }}">
        </form>
      </div>
    </div>
  </div>

  {% endfor %}
</div>
<script>
      function submitAddToCart(bookId) {
        const form = document.getElementById('add-to-cart-form-' + bookId);
        if (form) {
            form.submit();
        } else {
            alert("");
        }
    }

</script>

{% endblock %}